<!DOCTYPE html>
<html lang="en">
<head>
   <!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2PXG6EEVC0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2PXG6EEVC0');
</script> 
    <!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1383551356849358');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.net/tr?id=1383551356849358&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Is This Worth Selling? - AI-Powered Decision Helper</title>
    
    <!-- PWA Configuration -->
    <meta name="theme-color" content="#1e293b">
    <meta name="description" content="AI-powered app that searches real marketplace sold data to help you decide whether to sell items or donate them">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/icon.svg">
    
    <!-- iOS specific -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Worth Selling?">
    <link rel="apple-touch-icon" href="/icon.svg">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }

        h1 {
            color: #1e293b;
            font-size: 28px;
            margin-bottom: 10px;
            text-align: center;
            line-height: 1.2;
        }

        h1 .highlight {
            color: #0ea5e9;
        }

        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 25px;
            font-size: 16px;
        }

        .ai-badge {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 15px;
        }

        .pro-badge {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 15px;
        }

        /* Example Result Card */
        .example-result {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 2px solid #86efac;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
            position: relative;
        }

        .example-label {
            position: absolute;
            top: -10px;
            left: 20px;
            background: #22c55e;
            color: white;
            font-size: 11px;
            font-weight: 700;
            padding: 3px 10px;
            border-radius: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .example-item-name {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 12px;
            margin-top: 5px;
        }

        .example-stats {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .example-stat {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #475569;
        }

        .example-stat .check {
            color: #22c55e;
            font-weight: bold;
        }

        .example-verdict {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px dashed #86efac;
            font-size: 16px;
            font-weight: 700;
            color: #16a34a;
        }

        /* Input Section */
        .input-section {
            margin-top: 10px;
        }

        .input-label {
            display: block;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 12px;
            font-size: 18px;
            text-align: center;
        }

        input[type="text"], input[type="number"], textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 500;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #0ea5e9;
        }

        input::placeholder, textarea::placeholder {
            color: #94a3b8;
        }

        textarea {
            resize: vertical;
        }

        .action-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(14, 165, 233, 0.4);
        }

        .action-button:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .action-button.pro {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }

        .action-button.pro:hover {
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.4);
        }

        .time-hint {
            text-align: center;
            color: #64748b;
            font-size: 14px;
            margin-top: 12px;
        }

        .time-hint span {
            color: #0ea5e9;
            font-weight: 600;
        }

        /* Analysis Type Selection */
        .analysis-choice {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .analysis-option {
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .analysis-option:hover {
            border-color: #0ea5e9;
            background: #f8fafc;
        }

        .analysis-option.pro {
            border-color: #c4b5fd;
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
        }

        .analysis-option.pro:hover {
            border-color: #8b5cf6;
        }

        .analysis-option.locked {
            opacity: 0.7;
            cursor: default;
        }

        .analysis-option.locked:hover {
            border-color: #e2e8f0;
            background: white;
        }

        .analysis-option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .analysis-option-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
        }

        .analysis-option-title.pro {
            color: #7c3aed;
        }

        .analysis-option-badge {
            background: #0ea5e9;
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 10px;
        }

        .analysis-option-badge.pro {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .analysis-option-badge.locked {
            background: #94a3b8;
        }

        .analysis-option-desc {
            font-size: 14px;
            color: #64748b;
            line-height: 1.4;
        }

        .analysis-option-features {
            margin-top: 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .feature-tag {
            background: #f1f5f9;
            color: #475569;
            font-size: 12px;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .feature-tag.pro {
            background: #ede9fe;
            color: #7c3aed;
        }

        .lock-icon {
            font-size: 20px;
            margin-right: 8px;
        }

        /* Condition Selection */
        .question {
            margin-bottom: 25px;
        }

        .question-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            font-size: 18px;
        }

        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .button-grid.single-col {
            grid-template-columns: 1fr;
        }

        .option-button {
            padding: 16px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            font-weight: 500;
            color: #333;
        }

        .option-button:hover {
            border-color: #0ea5e9;
            background: #f0f9ff;
        }

        .option-button.selected {
            border-color: #0ea5e9;
            background: #0ea5e9;
            color: white;
        }

        .back-button {
            background: transparent;
            border: 2px solid #cbd5e1;
            color: #64748b;
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 12px;
            transition: all 0.2s;
        }

        .back-button:hover {
            border-color: #94a3b8;
            color: #475569;
            background: #f8fafc;
        }

        /* Progress indicator */
        .progress-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .progress-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #e2e8f0;
        }

        .progress-dot.active {
            background: #0ea5e9;
        }

        .progress-dot.completed {
            background: #10b981;
        }

        .progress-dot.pro {
            background: #8b5cf6;
        }

        /* Results */
        .result-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
        }

        .result-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .result-title.sell {
            color: #10b981;
        }

        .result-title.donate {
            color: #f59e0b;
        }

        .result-reason {
            color: #666;
            font-size: 16px;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .result-details {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: left;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: #666;
            font-weight: 500;
        }

        .detail-value {
            font-weight: 700;
            color: #333;
        }

        .detail-value.highlight {
            color: #10b981;
            font-size: 20px;
        }

        .market-data {
            background: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            text-align: left;
        }

        .market-data-title {
            font-weight: 600;
            color: #075985;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .market-data-content {
            color: #0c4a6e;
            font-size: 14px;
            line-height: 1.5;
        }

        .effort-score {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .effort-score.easy {
            background: #d1fae5;
            color: #065f46;
            border: 2px solid #10b981;
        }

        .effort-score.medium {
            background: #fef3c7;
            color: #92400e;
            border: 2px solid #f59e0b;
        }

        .effort-score.hard {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #ef4444;
        }

        .effort-reason {
            font-size: 14px;
            color: #64748b;
            margin-top: 8px;
            font-style: italic;
        }

        /* Detailed analysis badge on result */
        .detailed-badge {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 5px 12px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
        }

        /* Post-result actions */
        .result-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .primary-action {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .secondary-action {
            width: 100%;
            padding: 14px;
            background: white;
            color: #475569;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
        }

        .secondary-action:hover {
            border-color: #cbd5e1;
            background: #f8fafc;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
        }

        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #0ea5e9;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-spinner.pro {
            border-top-color: #8b5cf6;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: #0ea5e9;
            font-weight: 600;
            font-size: 16px;
        }

        .loading-text.pro {
            color: #8b5cf6;
        }

        .loading-subtext {
            color: #666;
            font-size: 14px;
            margin-top: 8px;
        }

        /* Scan Counter */
        .scan-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #1e293b, #334155);
            color: white;
            padding: 10px 18px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transition: all 0.2s;
        }

        .scan-counter:hover {
            transform: translateY(-2px);
        }

        .scan-counter.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .scan-counter.empty {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .scan-counter.paid {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        /* Bulk scan prompt */
        .bulk-prompt {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .bulk-prompt-title {
            font-weight: 600;
            color: #475569;
            margin-bottom: 8px;
        }

        .bulk-prompt-desc {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 12px;
        }

        .bulk-prompt-button {
            background: white;
            border: 2px solid #0ea5e9;
            color: #0ea5e9;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .bulk-prompt-button:hover {
            background: #0ea5e9;
            color: white;
        }

        /* History button */
        .history-button {
            position: fixed;
            bottom: 60px;
            right: 20px;
            background: linear-gradient(135deg, #1e293b, #334155);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .history-badge {
            background: #ef4444;
            color: white;
            border-radius: 50%;
            padding: 2px 8px;
            font-size: 12px;
            margin-left: 8px;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            width: 100%;
        }

        /* Footer */
        .footer-disclaimer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #0f172a;
            color: #94a3b8;
            padding: 12px 20px;
            font-size: 11px;
            text-align: center;
            z-index: 998;
            border-top: 1px solid #1e293b;
        }

        .footer-disclaimer a {
            color: #0ea5e9;
            text-decoration: none;
        }

        body {
            padding-bottom: 50px;
        }

        /* Bulk mode styles */
        .bulk-input-section textarea {
            min-height: 150px;
            resize: vertical;
        }

        .bulk-item-count {
            text-align: right;
            font-size: 14px;
            color: #64748b;
            margin-top: 8px;
        }

        .bulk-results {
            margin-top: 20px;
        }

        .bulk-result-item {
            background: #f8fafc;
            border-left: 4px solid #e0e0e0;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
        }

        .bulk-result-item.sell {
            border-left-color: #10b981;
            background: #f0fdf4;
        }

        .bulk-result-item.donate {
            border-left-color: #f59e0b;
            background: #fffbeb;
        }

        .bulk-item-name {
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .bulk-item-recommendation {
            font-weight: 700;
            font-size: 16px;
        }

        .bulk-item-recommendation.sell {
            color: #10b981;
        }

        .bulk-item-recommendation.donate {
            color: #f59e0b;
        }

        .bulk-item-details {
            font-size: 14px;
            color: #64748b;
            margin-top: 5px;
        }

        /* History modal */
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .history-title {
            font-size: 20px;
            font-weight: 700;
            color: #1e293b;
        }

        .history-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f0f9ff;
            border-radius: 12px;
        }

        .stat-box {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
        }

        .stat-label {
            font-size: 12px;
            color: #64748b;
        }

        .history-item {
            background: #f8fafc;
            border-left: 4px solid #cbd5e1;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
        }

        .history-item.sell {
            border-left-color: #10b981;
        }

        .history-item.donate {
            border-left-color: #f59e0b;
        }

        .close-button {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        /* Small input label */
        .small-label {
            display: block;
            font-size: 14px;
            color: #64748b;
            margin-bottom: 8px;
            font-weight: 500;
        }

        @keyframes emailSpinner {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ============================================
        // CONFIGURATION
        // ============================================
        const SCAN_CONFIG = {
            FREE_SCANS: 3,
            SALES_PAGE_URL: '/pricing.html'
        };

        // ============================================
        // GA4 TRACKING
        // ============================================
        function trackEvent(eventName, eventParams = {}) {
            if (typeof gtag !== 'undefined') {
                gtag('event', eventName, eventParams);
                console.log('GA4 Event:', eventName, eventParams);
            }
        }

        // ============================================
        // SCAN MANAGEMENT
        // ============================================
        function getScanData() {
            try {
                const data = localStorage.getItem('itemvalue_scans');
                if (data) {
                    const parsed = JSON.parse(data);
                    if (parsed.expiryDate && new Date(parsed.expiryDate) < new Date()) {
                        const freshData = {
                            tier: 'free',
                            scansRemaining: 0,
                            totalScans: SCAN_CONFIG.FREE_SCANS,
                            used: SCAN_CONFIG.FREE_SCANS,
                            expiryDate: null,
                            bundle: null
                        };
                        localStorage.setItem('itemvalue_scans', JSON.stringify(freshData));
                        return freshData;
                    }
                    return parsed;
                }
            } catch (e) {
                console.error('Error reading scan data:', e);
            }
            
            const defaultData = {
                tier: 'free',
                scansRemaining: SCAN_CONFIG.FREE_SCANS,
                totalScans: SCAN_CONFIG.FREE_SCANS,
                used: 0,
                expiryDate: null,
                bundle: null
            };
            localStorage.setItem('itemvalue_scans', JSON.stringify(defaultData));
            return defaultData;
        }

        function saveScanData(data) {
            localStorage.setItem('itemvalue_scans', JSON.stringify(data));
        }

        function decrementScan() {
            const data = getScanData();
            if (data.scansRemaining > 0) {
                data.scansRemaining--;
                data.used = (data.used || 0) + 1;
                saveScanData(data);
            }
            return data;
        }

        function canScan() {
            return getScanData().scansRemaining > 0;
        }

        function isPaidUser() {
            return getScanData().tier === 'paid';
        }

        // Check for access code in URL
        function checkAccessCode() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            
            if (code) {
                activateAccessCode(code);
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }

        function activateAccessCode(code) {
            const upperCode = code.toUpperCase();
            let bundle = null;
            let scans = 0;
            let days = 0;
            
            if (upperCode.includes('WEEKEND')) {
                bundle = 'Weekend Warrior';
                scans = 50;
                days = upperCode.includes('YEAR') ? 365 : 30;
            } else if (upperCode.includes('MOVING')) {
                bundle = 'Moving Master';
                scans = 200;
                days = upperCode.includes('YEAR') ? 365 : 60;
            } else if (upperCode.includes('ESTATE')) {
                bundle = 'Estate Pro';
                scans = 1000;
                days = upperCode.includes('YEAR') ? 365 : 90;
            } else {
                alert('Invalid access code.');
                return false;
            }
            
            const expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + days);
            
            const scanData = {
                tier: 'paid',
                bundle: bundle,
                scansRemaining: scans,
                totalScans: scans,
                used: 0,
                expiryDate: expiryDate.toISOString(),
                activatedDate: new Date().toISOString(),
                accessCode: code
            };
            
            saveScanData(scanData);
            trackEvent('bundle_activated', { bundle_name: bundle, scans_granted: scans });
            alert(`‚úÖ ${bundle} activated! You have ${scans} scans.`);
            window.location.reload();
            return true;
        }

        checkAccessCode();

        const CATEGORIES = [
            { id: 'electronics', label: 'üì± Electronics' },
            { id: 'clothing', label: 'üëï Clothing' },
            { id: 'home', label: 'üè† Home & Garden' },
            { id: 'toys', label: 'üéÆ Toys & Games' },
            { id: 'books', label: 'üìö Books & Media' },
            { id: 'collectibles', label: '‚≠ê Collectibles' },
            { id: 'furniture', label: 'ü™ë Furniture' },
            { id: 'sports', label: '‚öΩ Sports' },
        ];

        const CONDITIONS = [
            { id: 'new', label: 'üì¶ New/Sealed' },
            { id: 'likenew', label: '‚ú® Like New' },
            { id: 'good', label: 'üëç Good' },
            { id: 'fair', label: 'üëå Fair/Worn' },
        ];

        const URGENCY = [
            { id: 'week', label: 'üèÉ This Week' },
            { id: 'month', label: 'üìÖ This Month' },
            { id: 'whenever', label: '‚è∞ Whenever' },
        ];

        // ============================================
        // COMPONENTS
        // ============================================

        function ScanCounter({ onClick }) {
            const data = getScanData();
            const remaining = data.scansRemaining;
            const isPaid = data.tier === 'paid';
            
            let className = 'scan-counter';
            if (isPaid) className += ' paid';
            else if (remaining <= 0) className += ' empty';
            else if (remaining <= 1) className += ' warning';
            
            return (
                <div className={className} onClick={onClick}>
                    {isPaid ? '‚ú®' : 'üÜì'} {remaining} {isPaid ? 'scans' : 'free'} left
                </div>
            );
        }

        function UpgradeModal({ onClose, onShowEmailCapture }) {
            useEffect(() => {
                trackEvent('upgrade_prompt_shown', { scans_used: getScanData().used || 0 });
            }, []);

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()} style={{maxWidth: '420px', textAlign: 'center'}}>
                        <div style={{fontSize: '56px', marginBottom: '15px'}}>üîç</div>
                        <h2 style={{color: '#1e293b', marginBottom: '12px', fontSize: '22px'}}>You've Used Your Free Scans!</h2>
                        <p style={{color: '#64748b', marginBottom: '20px', fontSize: '15px', lineHeight: '1.5'}}>
                            Upgrade to keep discovering hidden value. Most users find $500+ worth of sellable items!
                        </p>
                        
                        <button 
                            onClick={() => {
                                trackEvent('upgrade_cta_clicked');
                                onClose();
                                onShowEmailCapture();
                            }}
                            style={{
                                width: '100%',
                                padding: '14px',
                                background: 'linear-gradient(135deg, #10b981, #059669)',
                                color: 'white',
                                border: 'none',
                                borderRadius: '12px',
                                fontSize: '16px',
                                fontWeight: '600',
                                cursor: 'pointer',
                                marginBottom: '10px'
                            }}
                        >
                            View Pricing Options ‚Üí
                        </button>
                        
                        <button 
                            onClick={() => { trackEvent('upgrade_dismissed'); onClose(); }}
                            style={{
                                width: '100%',
                                padding: '12px',
                                background: 'transparent',
                                color: '#64748b',
                                border: '2px solid #e2e8f0',
                                borderRadius: '12px',
                                fontSize: '15px',
                                cursor: 'pointer'
                            }}
                        >
                            Maybe Later
                        </button>
                    </div>
                </div>
            );
        }

        function AccountModal({ onClose }) {
            const data = getScanData();
            const isPaid = data.tier === 'paid';
            
            let expiryText = 'N/A';
            if (data.expiryDate) {
                const expiry = new Date(data.expiryDate);
                const daysLeft = Math.ceil((expiry - new Date()) / (1000 * 60 * 60 * 24));
                expiryText = `${daysLeft} days left`;
            }
            
            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()} style={{maxWidth: '380px'}}>
                        <h2 style={{marginBottom: '20px', color: '#1e293b'}}>üìä Your Account</h2>
                        
                        <div style={{background: '#f8fafc', padding: '20px', borderRadius: '12px', marginBottom: '20px'}}>
                            <div style={{marginBottom: '15px'}}>
                                <div style={{color: '#64748b', fontSize: '13px'}}>Plan</div>
                                <div style={{color: '#1e293b', fontSize: '18px', fontWeight: '700'}}>
                                    {isPaid ? data.bundle : 'Free Tier'}
                                </div>
                            </div>
                            
                            <div style={{marginBottom: isPaid ? '15px' : '0'}}>
                                <div style={{color: '#64748b', fontSize: '13px'}}>Scans Remaining</div>
                                <div style={{color: '#10b981', fontSize: '24px', fontWeight: '700'}}>
                                    {data.scansRemaining} / {data.totalScans}
                                </div>
                            </div>
                            
                            {isPaid && (
                                <>
                                    <div style={{marginBottom: '15px'}}>
                                        <div style={{color: '#64748b', fontSize: '13px'}}>Expires</div>
                                        <div style={{color: '#1e293b', fontSize: '16px', fontWeight: '600'}}>{expiryText}</div>
                                    </div>
                                    <div style={{background: 'linear-gradient(135deg, #ede9fe, #ddd6fe)', padding: '10px', borderRadius: '8px'}}>
                                        <div style={{color: '#7c3aed', fontSize: '13px', fontWeight: '600'}}>‚ú® Detailed Analysis Unlocked</div>
                                    </div>
                                </>
                            )}
                        </div>
                        
                        {!isPaid && (
                            <a href={SCAN_CONFIG.SALES_PAGE_URL} style={{
                                display: 'block',
                                padding: '14px',
                                background: 'linear-gradient(135deg, #0ea5e9, #0284c7)',
                                color: 'white',
                                borderRadius: '12px',
                                fontSize: '15px',
                                fontWeight: '600',
                                textAlign: 'center',
                                textDecoration: 'none',
                                marginBottom: '10px'
                            }}>
                                Upgrade for More Scans
                            </a>
                        )}
                        
                        <button onClick={onClose} style={{
                            width: '100%',
                            padding: '12px',
                            background: '#6b7280',
                            color: 'white',
                            border: 'none',
                            borderRadius: '12px',
                            fontSize: '15px',
                            fontWeight: '600',
                            cursor: 'pointer'
                        }}>
                            Close
                        </button>
                    </div>
                </div>
            );
        }

        function EmailCaptureModal({ onClose, lastItem }) {
            const [email, setEmail] = useState('');
            const [firstName, setFirstName] = useState('');
            const [isLoading, setIsLoading] = useState(false);

            const handleSubmit = async () => {
                if (!email || !email.includes('@')) {
                    alert('Please enter a valid email');
                    return;
                }
                setIsLoading(true);
                trackEvent('email_captured', { has_first_name: !!firstName });

                try {
                    await fetch('/.netlify/functions/capture-email', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            email,
                            firstName: firstName || null,
                            scansUsed: getScanData().used || 3,
                            lastItemScanned: lastItem
                        })
                    });
                    localStorage.setItem('itemvalue_user_email', email);
                } catch (e) {
                    console.error('Email capture error:', e);
                }
                window.location.href = SCAN_CONFIG.SALES_PAGE_URL;
            };

            const handleSkip = () => {
                trackEvent('email_skipped');
                window.location.href = SCAN_CONFIG.SALES_PAGE_URL;
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()} style={{maxWidth: '420px', position: 'relative'}}>
                        <div style={{background: 'linear-gradient(135deg, #0ea5e9, #0284c7)', padding: '25px', margin: '-30px -30px 25px -30px', borderRadius: '16px 16px 0 0', textAlign: 'center'}}>
                            <div style={{fontSize: '48px', marginBottom: '10px'}}>üîç</div>
                            <h2 style={{color: 'white', margin: '0', fontSize: '20px'}}>You've Used Your Free Scans!</h2>
                        </div>
                        
                        {!isLoading ? (
                            <>
                                <p style={{color: '#475569', marginBottom: '15px', fontSize: '15px'}}>
                                    Enter your email for <strong>exclusive pricing</strong>:
                                </p>
                                
                                <input 
                                    type="text" 
                                    placeholder="First name (optional)"
                                    value={firstName}
                                    onChange={(e) => setFirstName(e.target.value)}
                                    style={{width: '100%', padding: '12px 14px', border: '2px solid #e2e8f0', borderRadius: '8px', fontSize: '16px', marginBottom: '10px'}}
                                />
                                
                                <input 
                                    type="email" 
                                    placeholder="Email address"
                                    value={email}
                                    onChange={(e) => setEmail(e.target.value)}
                                    style={{width: '100%', padding: '12px 14px', border: '2px solid #e2e8f0', borderRadius: '8px', fontSize: '16px', marginBottom: '15px'}}
                                />
                                
                                <button onClick={handleSubmit} style={{
                                    width: '100%',
                                    background: 'linear-gradient(135deg, #10b981, #059669)',
                                    color: 'white',
                                    padding: '14px',
                                    border: 'none',
                                    borderRadius: '8px',
                                    fontSize: '16px',
                                    fontWeight: '600',
                                    cursor: 'pointer'
                                }}>
                                    See My Options ‚Üí
                                </button>
                                
                                <p style={{textAlign: 'center', marginTop: '12px'}}>
                                    <a onClick={handleSkip} style={{color: '#94a3b8', fontSize: '13px', cursor: 'pointer'}}>
                                        No thanks, I'll pay full price ‚Üí
                                    </a>
                                </p>
                            </>
                        ) : (
                            <div style={{textAlign: 'center', padding: '20px'}}>
                                <div style={{width: '40px', height: '40px', border: '3px solid #e2e8f0', borderTopColor: '#0ea5e9', borderRadius: '50%', animation: 'emailSpinner 1s linear infinite', margin: '0 auto 15px'}}></div>
                                <p style={{color: '#64748b'}}>Saving...</p>
                            </div>
                        )}
                        
                        <button onClick={onClose} style={{position: 'absolute', top: '15px', right: '15px', background: 'rgba(255,255,255,0.2)', border: 'none', color: 'white', width: '30px', height: '30px', borderRadius: '50%', fontSize: '16px', cursor: 'pointer'}}>√ó</button>
                    </div>
                </div>
            );
        }

        function HistoryModal({ history, onClose, onClear }) {
            const sellItems = history.filter(item => item.recommendation === 'sell');
            const donateItems = history.filter(item => item.recommendation === 'donate');
            const totalProfit = sellItems.reduce((sum, item) => sum + parseFloat(item.netProfit || 0), 0);

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                        <div className="history-header">
                            <h2 className="history-title">üìã History</h2>
                            <div style={{display: 'flex', gap: '8px'}}>
                                <button onClick={onClear} style={{background: '#f1f5f9', border: 'none', padding: '8px 12px', borderRadius: '8px', cursor: 'pointer', fontSize: '13px'}}>üóëÔ∏è Clear</button>
                                <button className="close-button" onClick={onClose}>‚úï</button>
                            </div>
                        </div>

                        <div className="history-stats">
                            <div className="stat-box">
                                <div className="stat-number">{history.length}</div>
                                <div className="stat-label">Items</div>
                            </div>
                            <div className="stat-box">
                                <div className="stat-number" style={{color: '#10b981'}}>{sellItems.length}</div>
                                <div className="stat-label">Sell</div>
                            </div>
                            <div className="stat-box">
                                <div className="stat-number" style={{color: '#f59e0b'}}>{donateItems.length}</div>
                                <div className="stat-label">Donate</div>
                            </div>
                        </div>

                        {sellItems.length > 0 && (
                            <div style={{marginBottom: '15px', padding: '12px', background: '#f0fdf4', borderRadius: '10px', textAlign: 'center'}}>
                                <div style={{fontSize: '13px', color: '#065f46'}}>Potential profit</div>
                                <div style={{fontSize: '24px', fontWeight: '700', color: '#10b981'}}>${totalProfit.toFixed(2)}</div>
                            </div>
                        )}

                        <div style={{maxHeight: '300px', overflowY: 'auto'}}>
                            {history.map((item) => (
                                <div key={item.id} className={`history-item ${item.recommendation}`}>
                                    <div style={{fontWeight: '600', color: '#1e293b', marginBottom: '4px'}}>
                                        {item.itemName}
                                        {item.analysisType === 'detailed' && (
                                            <span style={{marginLeft: '8px', background: '#ede9fe', color: '#7c3aed', fontSize: '10px', padding: '2px 6px', borderRadius: '10px'}}>DETAILED</span>
                                        )}
                                    </div>
                                    <div style={{fontSize: '13px'}}>
                                        <span style={{color: item.recommendation === 'sell' ? '#10b981' : '#f59e0b', fontWeight: '600'}}>
                                            {item.recommendation === 'sell' ? 'üí∞ SELL' : '‚ù§Ô∏è DONATE'}
                                        </span>
                                        {item.recommendation === 'sell' && (
                                            <span style={{color: '#64748b', marginLeft: '10px'}}>Net: ${item.netProfit}</span>
                                        )}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // ============================================
        // MAIN APP
        // ============================================
        function App() {
            // Screens: home, chooseType, condition, loading, result, 
            //          detailed_category, detailed_condition, detailed_price, detailed_urgency, detailed_extras
            //          bulk, bulkResults
            const [screen, setScreen] = useState('home');
            const [analysisType, setAnalysisType] = useState('quick'); // 'quick' or 'detailed'
            const [itemDescription, setItemDescription] = useState('');
            const [condition, setCondition] = useState(null);
            const [category, setCategory] = useState(null);
            const [originalPrice, setOriginalPrice] = useState('');
            const [urgency, setUrgency] = useState(null);
            const [brand, setBrand] = useState('');
            const [defects, setDefects] = useState('');
            const [additionalInfo, setAdditionalInfo] = useState('');
            const [result, setResult] = useState(null);
            const [history, setHistory] = useState(() => {
                const saved = localStorage.getItem('sellDonateHistory');
                return saved ? JSON.parse(saved) : [];
            });
            const [scanData, setScanData] = useState(getScanData());
            
            // Modals
            const [showUpgrade, setShowUpgrade] = useState(false);
            const [showAccount, setShowAccount] = useState(false);
            const [showEmailCapture, setShowEmailCapture] = useState(false);
            const [showHistory, setShowHistory] = useState(false);

            // Bulk mode
            const [bulkItems, setBulkItems] = useState('');
            const [bulkResults, setBulkResults] = useState([]);

            const refreshScanData = () => setScanData(getScanData());

            const handleShowEmailCapture = () => {
                if (localStorage.getItem('itemvalue_user_email')) {
                    window.location.href = SCAN_CONFIG.SALES_PAGE_URL;
                } else {
                    setShowEmailCapture(true);
                }
            };

            const startAnalysis = () => {
                if (!canScan()) {
                    setShowUpgrade(true);
                    return;
                }
                if (!itemDescription.trim()) return;
                
                trackEvent('item_entered', { item_length: itemDescription.length });
                setScreen('chooseType');
            };

            const selectAnalysisType = (type) => {
                setAnalysisType(type);
                trackEvent('analysis_type_selected', { type, is_paid: isPaidUser() });
                
                if (type === 'quick') {
                    setScreen('condition');
                } else {
                    setScreen('detailed_category');
                }
            };

            const runAnalysis = async () => {
                if (!canScan()) {
                    setShowUpgrade(true);
                    return;
                }

                setScreen('loading');
                
                const isDetailed = analysisType === 'detailed';
                trackEvent('analysis_started', { 
                    mode: 'single', 
                    analysis_type: analysisType,
                    condition 
                });

                const conditionLabel = CONDITIONS.find(c => c.id === condition)?.label.split(' ').slice(1).join(' ');
                const categoryLabel = isDetailed && category ? CATEGORIES.find(c => c.id === category)?.label.split(' ').slice(1).join(' ') : 'General';
                const urgencyLabel = isDetailed && urgency ? URGENCY.find(u => u.id === urgency)?.label.split(' ').slice(1).join(' ') : 'Whenever it Sells';

                try {
                    const response = await fetch('/.netlify/functions/analyze', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            itemDescription,
                            category: categoryLabel,
                            condition: conditionLabel,
                            originalPrice: isDetailed ? originalPrice : '',
                            urgency: urgencyLabel,
                            brand: isDetailed ? brand : '',
                            defects: isDetailed ? defects : '',
                            additionalInfo: isDetailed ? additionalInfo : ''
                        })
                    });

                    if (!response.ok) throw new Error(`HTTP ${response.status}`);

                    const data = await response.json();
                    let responseText = '';
                    if (data.content) {
                        for (const block of data.content) {
                            if (block.type === 'text') responseText += block.text;
                        }
                    }

                    let cleanedResponse = responseText.trim().replace(/```json\n?/g, '').replace(/```\n?/g, '');
                    const jsonMatch = cleanedResponse.match(/\{[\s\S]*\}/);
                    if (jsonMatch) cleanedResponse = jsonMatch[0];

                    const aiResult = JSON.parse(cleanedResponse);

                    const resultData = {
                        recommendation: aiResult.recommendation.toLowerCase(),
                        reason: aiResult.reason,
                        effortScore: aiResult.effortScore || 'medium',
                        effortReason: aiResult.effortReason || '',
                        marketData: aiResult.marketData,
                        estimatedPrice: parseFloat(aiResult.estimatedSalePrice).toFixed(2),
                        ebayFees: parseFloat(aiResult.platformFees || aiResult.ebayFees).toFixed(2),
                        shippingCost: parseFloat(aiResult.shippingCost).toFixed(2),
                        netProfit: parseFloat(aiResult.netProfit).toFixed(2),
                        taxDeduction: parseFloat(aiResult.taxDeduction).toFixed(2),
                        analysisType: analysisType
                    };

                    setResult(resultData);
                    setScreen('result');

                    trackEvent('analysis_completed', {
                        mode: 'single',
                        analysis_type: analysisType,
                        recommendation: resultData.recommendation,
                        net_profit: parseFloat(resultData.netProfit)
                    });

                    decrementScan();
                    refreshScanData();

                    const historyItem = {
                        id: Date.now(),
                        timestamp: new Date().toISOString(),
                        itemName: itemDescription,
                        condition,
                        analysisType,
                        ...resultData
                    };
                    const updatedHistory = [historyItem, ...history];
                    setHistory(updatedHistory);
                    localStorage.setItem('sellDonateHistory', JSON.stringify(updatedHistory));

                } catch (error) {
                    console.error('Analysis error:', error);
                    trackEvent('analysis_error', { mode: 'single', error_type: 'api_error' });
                    alert('Something went wrong. Please try again.');
                    setScreen('home');
                }
            };

            const runBulkAnalysis = async () => {
                const items = bulkItems.split('\n').filter(i => i.trim());
                if (items.length === 0) return;

                if (!canScan()) {
                    setShowUpgrade(true);
                    return;
                }

                const currentScans = getScanData().scansRemaining;
                if (currentScans < items.length) {
                    alert(`You only have ${currentScans} scans but are trying to analyze ${items.length} items.`);
                    return;
                }

                setScreen('loading');
                trackEvent('analysis_started', { mode: 'bulk', item_count: items.length });

                const results = [];

                for (const itemName of items) {
                    try {
                        const response = await fetch('/.netlify/functions/analyze', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                itemDescription: itemName.trim(),
                                category: 'General',
                                condition: 'Good Used',
                                originalPrice: '',
                                urgency: 'Whenever it Sells',
                                brand: '',
                                defects: '',
                                additionalInfo: ''
                            })
                        });

                        if (!response.ok) throw new Error(`HTTP ${response.status}`);

                        const data = await response.json();
                        let responseText = '';
                        if (data.content) {
                            for (const block of data.content) {
                                if (block.type === 'text') responseText += block.text;
                            }
                        }

                        let cleanedResponse = responseText.trim().replace(/```json\n?/g, '').replace(/```\n?/g, '');
                        const jsonMatch = cleanedResponse.match(/\{[\s\S]*\}/);
                        if (jsonMatch) cleanedResponse = jsonMatch[0];

                        const aiResult = JSON.parse(cleanedResponse);

                        results.push({
                            itemName: itemName.trim(),
                            recommendation: aiResult.recommendation.toLowerCase(),
                            reason: aiResult.reason,
                            netProfit: parseFloat(aiResult.netProfit).toFixed(2),
                            estimatedPrice: parseFloat(aiResult.estimatedSalePrice).toFixed(2)
                        });

                        decrementScan();
                    } catch (error) {
                        results.push({
                            itemName: itemName.trim(),
                            recommendation: 'error',
                            reason: 'Could not analyze',
                            netProfit: '0'
                        });
                    }
                }

                setBulkResults(results);
                setScreen('bulkResults');
                refreshScanData();

                trackEvent('analysis_completed', {
                    mode: 'bulk',
                    item_count: results.length,
                    sell_count: results.filter(r => r.recommendation === 'sell').length
                });

                const historyItems = results.map(r => ({
                    id: Date.now() + Math.random(),
                    timestamp: new Date().toISOString(),
                    analysisType: 'quick',
                    ...r
                }));
                const updatedHistory = [...historyItems, ...history];
                setHistory(updatedHistory);
                localStorage.setItem('sellDonateHistory', JSON.stringify(updatedHistory));
            };

            const reset = () => {
                setScreen('home');
                setAnalysisType('quick');
                setItemDescription('');
                setCondition(null);
                setCategory(null);
                setOriginalPrice('');
                setUrgency(null);
                setBrand('');
                setDefects('');
                setAdditionalInfo('');
                setResult(null);
                setBulkItems('');
                setBulkResults([]);
                refreshScanData();
            };

            const paid = isPaidUser();

            // ============================================
            // SCREENS
            // ============================================

            // Loading
            if (screen === 'loading') {
                const isDetailed = analysisType === 'detailed';
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        <div className="container">
                            <div className="card">
                                <div className="loading">
                                    <div className={`loading-spinner ${isDetailed ? 'pro' : ''}`}></div>
                                    <div className={`loading-text ${isDetailed ? 'pro' : ''}`}>
                                        {isDetailed ? '‚ú® Running Detailed Analysis...' : 'üîç Searching marketplace data...'}
                                    </div>
                                    <div className="loading-subtext">
                                        {isDetailed ? 'Analyzing with all your specifications' : 'Finding real sold prices for your item'}
                                    </div>
                                </div>
                            </div>
                        </div>
                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                    </>
                );
            }

            // Home
            if (screen === 'home') {
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center'}}>
                                    <div className="ai-badge">‚ú® Real Market Data + AI</div>
                                </div>
                                
                                <h1>
                                    Stop Guessing.<br/>
                                    <span className="highlight">Know What It's Worth.</span>
                                </h1>
                                
                                <p className="subtitle">
                                    Find out in 30 seconds if your item is worth selling online.
                                </p>

                                <div className="example-result">
                                    <div className="example-label">Example Result</div>
                                    <div className="example-item-name">Nike Air Max 270 - Size 10</div>
                                    <div className="example-stats">
                                        <div className="example-stat">
                                            <span className="check">‚úì</span>
                                            <span>Avg sold price: <strong>$85</strong></span>
                                        </div>
                                        <div className="example-stat">
                                            <span className="check">‚úì</span>
                                            <span>After fees & shipping: <strong>$62</strong></span>
                                        </div>
                                    </div>
                                    <div className="example-verdict">üí∞ Verdict: WORTH SELLING</div>
                                </div>

                                <div className="input-section">
                                    <label className="input-label">What do you want to check?</label>
                                    <input
                                        type="text"
                                        placeholder="e.g., iPhone 12, KitchenAid mixer, Levi's jeans..."
                                        value={itemDescription}
                                        onChange={(e) => setItemDescription(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && startAnalysis()}
                                    />
                                    
                                    <button 
                                        className="action-button"
                                        disabled={!itemDescription.trim()}
                                        onClick={startAnalysis}
                                    >
                                        Check My Item ‚Äî Free ‚úì
                                    </button>
                                    
                                    <div className="time-hint">
                                        ‚è± Takes about <span>30 seconds</span>
                                    </div>
                                </div>

                                <div className="bulk-prompt">
                                    <div className="bulk-prompt-title">Have multiple items?</div>
                                    <div className="bulk-prompt-desc">Check them all at once with bulk scan</div>
                                    <button 
                                        className="bulk-prompt-button"
                                        onClick={() => {
                                            if (!canScan()) {
                                                setShowUpgrade(true);
                                            } else {
                                                trackEvent('mode_selected', { mode: 'bulk' });
                                                setScreen('bulk');
                                            }
                                        }}
                                    >
                                        Try Bulk Scan ‚Üí
                                    </button>
                                </div>
                            </div>
                        </div>

                        {history.length > 0 && (
                            <button className="history-button" onClick={() => setShowHistory(true)}>
                                üìã History <span className="history-badge">{history.length}</span>
                            </button>
                        )}

                        {showHistory && (
                            <HistoryModal 
                                history={history}
                                onClose={() => setShowHistory(false)}
                                onClear={() => {
                                    setHistory([]);
                                    localStorage.removeItem('sellDonateHistory');
                                    setShowHistory(false);
                                }}
                            />
                        )}
                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                        {showUpgrade && <UpgradeModal onClose={() => setShowUpgrade(false)} onShowEmailCapture={handleShowEmailCapture} />}
                        {showEmailCapture && <EmailCaptureModal onClose={() => setShowEmailCapture(false)} lastItem={null} />}
                    </>
                );
            }

            // Choose Analysis Type
            if (screen === 'chooseType') {
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center', marginBottom: '5px'}}>
                                    <div className="ai-badge">Choose Analysis Type</div>
                                </div>
                                
                                <h1 style={{fontSize: '22px', marginBottom: '8px'}}>
                                    How detailed do you want?
                                </h1>
                                
                                <p className="subtitle" style={{marginBottom: '20px'}}>
                                    Checking: <strong>{itemDescription}</strong>
                                </p>

                                <div className="analysis-choice">
                                    {/* Quick Check Option */}
                                    <div 
                                        className="analysis-option"
                                        onClick={() => selectAnalysisType('quick')}
                                    >
                                        <div className="analysis-option-header">
                                            <div className="analysis-option-title">‚ö° Quick Check</div>
                                            <div className="analysis-option-badge">30 sec</div>
                                        </div>
                                        <div className="analysis-option-desc">
                                            Fast answer based on item + condition. Great for most items.
                                        </div>
                                        <div className="analysis-option-features">
                                            <span className="feature-tag">Sell/Donate verdict</span>
                                            <span className="feature-tag">Price estimate</span>
                                            <span className="feature-tag">Net profit</span>
                                        </div>
                                    </div>

                                    {/* Detailed Analysis Option */}
                                    <div 
                                        className={`analysis-option pro ${!paid ? 'locked' : ''}`}
                                        onClick={() => {
                                            if (paid) {
                                                selectAnalysisType('detailed');
                                            } else {
                                                trackEvent('detailed_analysis_teaser_clicked');
                                                setShowUpgrade(true);
                                            }
                                        }}
                                    >
                                        <div className="analysis-option-header">
                                            <div className="analysis-option-title pro">
                                                {!paid && <span className="lock-icon">üîí</span>}
                                                ‚ú® Detailed Analysis
                                            </div>
                                            <div className={`analysis-option-badge ${paid ? 'pro' : 'locked'}`}>
                                                {paid ? 'PRO' : 'UPGRADE'}
                                            </div>
                                        </div>
                                        <div className="analysis-option-desc">
                                            {paid 
                                                ? 'More accurate with category, original price, urgency & condition details.'
                                                : 'Unlock with any paid plan for more accurate recommendations.'}
                                        </div>
                                        <div className="analysis-option-features">
                                            <span className="feature-tag pro">Category-specific data</span>
                                            <span className="feature-tag pro">Effort score</span>
                                            <span className="feature-tag pro">Urgency factors</span>
                                            <span className="feature-tag pro">Defect adjustments</span>
                                        </div>
                                    </div>
                                </div>

                                <button 
                                    className="back-button"
                                    onClick={() => setScreen('home')}
                                    style={{marginTop: '20px'}}
                                >
                                    ‚Üê Back
                                </button>
                            </div>
                        </div>

                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                        {showUpgrade && <UpgradeModal onClose={() => setShowUpgrade(false)} onShowEmailCapture={handleShowEmailCapture} />}
                        {showEmailCapture && <EmailCaptureModal onClose={() => setShowEmailCapture(false)} lastItem={null} />}
                    </>
                );
            }

            // Quick: Condition selection
            if (screen === 'condition') {
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center', marginBottom: '5px'}}>
                                    <div className="ai-badge">‚ö° Quick Check</div>
                                </div>
                                
                                <h1 style={{fontSize: '22px', marginBottom: '8px'}}>
                                    What condition is it in?
                                </h1>
                                
                                <p className="subtitle" style={{marginBottom: '20px'}}>
                                    Checking: <strong>{itemDescription}</strong>
                                </p>

                                <div className="button-grid">
                                    {CONDITIONS.map(cond => (
                                        <button
                                            key={cond.id}
                                            className={`option-button ${condition === cond.id ? 'selected' : ''}`}
                                            onClick={() => setCondition(cond.id)}
                                        >
                                            {cond.label}
                                        </button>
                                    ))}
                                </div>

                                <button 
                                    className="back-button"
                                    onClick={() => setScreen('chooseType')}
                                    style={{marginTop: '20px'}}
                                >
                                    ‚Üê Back
                                </button>

                                <button 
                                    className="action-button"
                                    disabled={!condition}
                                    onClick={runAnalysis}
                                    style={{marginTop: '10px'}}
                                >
                                    üîç Get My Answer
                                </button>
                            </div>
                        </div>

                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                        {showUpgrade && <UpgradeModal onClose={() => setShowUpgrade(false)} onShowEmailCapture={handleShowEmailCapture} />}
                    </>
                );
            }

            // Detailed: Category
            if (screen === 'detailed_category') {
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center', marginBottom: '5px'}}>
                                    <div className="pro-badge">‚ú® Detailed Analysis ‚Äî Step 1/5</div>
                                </div>
                                
                                <div className="progress-dots">
                                    <div className="progress-dot pro active"></div>
                                    <div className="progress-dot"></div>
                                    <div className="progress-dot"></div>
                                    <div className="progress-dot"></div>
                                    <div className="progress-dot"></div>
                                </div>
                                
                                <h1 style={{fontSize: '22px', marginBottom: '20px'}}>
                                    What type of item is it?
                                </h1>

                                <div className="button-grid">
                                    {CATEGORIES.map(cat => (
                                        <button
                                            key={cat.id}
                                            className={`option-button ${category === cat.id ? 'selected' : ''}`}
                                            onClick={() => setCategory(cat.id)}
                                        >
                                            {cat.label}
                                        </button>
                                    ))}
                                </div>

                                <button 
                                    className="back-button"
                                    onClick={() => setScreen('chooseType')}
                                    style={{marginTop: '20px'}}
                                >
                                    ‚Üê Back
                                </button>

                                <button 
                                    className="action-button pro"
                                    disabled={!category}
                                    onClick={() => setScreen('detailed_condition')}
                                    style={{marginTop: '10px'}}
                                >
                                    Next ‚Üí
                                </button>
                            </div>
                        </div>

                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                    </>
                );
            }

            // Detailed: Condition
            if (screen === 'detailed_condition') {
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center', marginBottom: '5px'}}>
                                    <div className="pro-badge">‚ú® Detailed Analysis ‚Äî Step 2/5</div>
                                </div>
                                
                                <div className="progress-dots">
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro active"></div>
                                    <div className="progress-dot"></div>
                                    <div className="progress-dot"></div>
                                    <div className="progress-dot"></div>
                                </div>
                                
                                <h1 style={{fontSize: '22px', marginBottom: '20px'}}>
                                    What condition is it in?
                                </h1>

                                <div className="button-grid">
                                    {CONDITIONS.map(cond => (
                                        <button
                                            key={cond.id}
                                            className={`option-button ${condition === cond.id ? 'selected' : ''}`}
                                            onClick={() => setCondition(cond.id)}
                                        >
                                            {cond.label}
                                        </button>
                                    ))}
                                </div>

                                <button 
                                    className="back-button"
                                    onClick={() => setScreen('detailed_category')}
                                    style={{marginTop: '20px'}}
                                >
                                    ‚Üê Back
                                </button>

                                <button 
                                    className="action-button pro"
                                    disabled={!condition}
                                    onClick={() => setScreen('detailed_price')}
                                    style={{marginTop: '10px'}}
                                >
                                    Next ‚Üí
                                </button>
                            </div>
                        </div>

                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                    </>
                );
            }

            // Detailed: Original Price
            if (screen === 'detailed_price') {
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center', marginBottom: '5px'}}>
                                    <div className="pro-badge">‚ú® Detailed Analysis ‚Äî Step 3/5</div>
                                </div>
                                
                                <div className="progress-dots">
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro active"></div>
                                    <div className="progress-dot"></div>
                                    <div className="progress-dot"></div>
                                </div>
                                
                                <h1 style={{fontSize: '22px', marginBottom: '10px'}}>
                                    What did you pay for it?
                                </h1>
                                <p className="subtitle" style={{marginBottom: '20px'}}>Optional ‚Äî helps calculate if it's worth your time</p>

                                <input
                                    type="number"
                                    placeholder="$0 or leave blank"
                                    value={originalPrice}
                                    onChange={(e) => setOriginalPrice(e.target.value)}
                                    min="0"
                                />

                                <button 
                                    className="back-button"
                                    onClick={() => setScreen('detailed_condition')}
                                    style={{marginTop: '20px'}}
                                >
                                    ‚Üê Back
                                </button>

                                <button 
                                    className="action-button pro"
                                    onClick={() => setScreen('detailed_urgency')}
                                    style={{marginTop: '10px'}}
                                >
                                    Next ‚Üí
                                </button>
                            </div>
                        </div>

                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                    </>
                );
            }

            // Detailed: Urgency
            if (screen === 'detailed_urgency') {
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center', marginBottom: '5px'}}>
                                    <div className="pro-badge">‚ú® Detailed Analysis ‚Äî Step 4/5</div>
                                </div>
                                
                                <div className="progress-dots">
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro active"></div>
                                    <div className="progress-dot"></div>
                                </div>
                                
                                <h1 style={{fontSize: '22px', marginBottom: '20px'}}>
                                    How fast do you need it gone?
                                </h1>

                                <div className="button-grid single-col">
                                    {URGENCY.map(urg => (
                                        <button
                                            key={urg.id}
                                            className={`option-button ${urgency === urg.id ? 'selected' : ''}`}
                                            onClick={() => setUrgency(urg.id)}
                                        >
                                            {urg.label}
                                        </button>
                                    ))}
                                </div>

                                <button 
                                    className="back-button"
                                    onClick={() => setScreen('detailed_price')}
                                    style={{marginTop: '20px'}}
                                >
                                    ‚Üê Back
                                </button>

                                <button 
                                    className="action-button pro"
                                    disabled={!urgency}
                                    onClick={() => setScreen('detailed_extras')}
                                    style={{marginTop: '10px'}}
                                >
                                    Next ‚Üí
                                </button>
                            </div>
                        </div>

                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                    </>
                );
            }

            // Detailed: Extras
            if (screen === 'detailed_extras') {
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center', marginBottom: '5px'}}>
                                    <div className="pro-badge">‚ú® Detailed Analysis ‚Äî Step 5/5</div>
                                </div>
                                
                                <div className="progress-dots">
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro completed"></div>
                                    <div className="progress-dot pro active"></div>
                                </div>
                                
                                <h1 style={{fontSize: '22px', marginBottom: '10px'}}>
                                    Any extra details?
                                </h1>
                                <p className="subtitle" style={{marginBottom: '20px'}}>Optional ‚Äî improves accuracy</p>

                                <div style={{marginBottom: '15px'}}>
                                    <label className="small-label">Brand or maker</label>
                                    <input
                                        type="text"
                                        placeholder="e.g., Nike, Apple, IKEA"
                                        value={brand}
                                        onChange={(e) => setBrand(e.target.value)}
                                    />
                                </div>

                                <div style={{marginBottom: '15px'}}>
                                    <label className="small-label">Any damage or defects?</label>
                                    <textarea
                                        placeholder="e.g., Small scratch, missing piece..."
                                        value={defects}
                                        onChange={(e) => setDefects(e.target.value)}
                                        rows="2"
                                    />
                                </div>

                                <div style={{marginBottom: '15px'}}>
                                    <label className="small-label">Anything else?</label>
                                    <textarea
                                        placeholder="e.g., Original box, limited edition..."
                                        value={additionalInfo}
                                        onChange={(e) => setAdditionalInfo(e.target.value)}
                                        rows="2"
                                    />
                                </div>

                                <button 
                                    className="back-button"
                                    onClick={() => setScreen('detailed_urgency')}
                                >
                                    ‚Üê Back
                                </button>

                                <button 
                                    className="action-button pro"
                                    onClick={runAnalysis}
                                    style={{marginTop: '10px'}}
                                >
                                    ‚ú® Run Detailed Analysis
                                </button>
                            </div>
                        </div>

                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                    </>
                );
            }

            // Result
            if (screen === 'result' && result) {
                const isDetailed = result.analysisType === 'detailed';
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="result-card">
                                {isDetailed && <div className="detailed-badge">‚ú® Detailed Analysis</div>}
                                {!isDetailed && <div className="ai-badge">‚ö° Quick Check</div>}
                                
                                <div className="result-icon">
                                    {result.recommendation === 'sell' ? 'üí∞' : '‚ù§Ô∏è'}
                                </div>
                                
                                <h2 className={`result-title ${result.recommendation}`}>
                                    {result.recommendation === 'sell' ? 'SELL IT!' : 'DONATE IT'}
                                </h2>
                                
                                <p className="result-reason">{result.reason}</p>

                                {result.effortScore && (
                                    <div>
                                        <div className={`effort-score ${result.effortScore}`}>
                                            {result.effortScore === 'easy' && 'üü¢ Easy to Sell'}
                                            {result.effortScore === 'medium' && 'üü° Medium Effort'}
                                            {result.effortScore === 'hard' && 'üî¥ Hard to Sell'}
                                        </div>
                                        {result.effortReason && (
                                            <div className="effort-reason">{result.effortReason}</div>
                                        )}
                                    </div>
                                )}

                                {result.marketData && (
                                    <div className="market-data">
                                        <div className="market-data-title">üìä Real Marketplace Data</div>
                                        <div className="market-data-content">{result.marketData}</div>
                                    </div>
                                )}

                                <div className="result-details">
                                    {result.recommendation === 'sell' ? (
                                        <>
                                            <div className="detail-row">
                                                <span className="detail-label">Est. Sale Price</span>
                                                <span className="detail-value">${result.estimatedPrice}</span>
                                            </div>
                                            <div className="detail-row">
                                                <span className="detail-label">Fees & Shipping</span>
                                                <span className="detail-value">-${(parseFloat(result.ebayFees) + parseFloat(result.shippingCost)).toFixed(2)}</span>
                                            </div>
                                            <div className="detail-row">
                                                <span className="detail-label">Your Profit</span>
                                                <span className="detail-value highlight">${result.netProfit}</span>
                                            </div>
                                        </>
                                    ) : (
                                        <>
                                            <div className="detail-row">
                                                <span className="detail-label">Tax Deduction</span>
                                                <span className="detail-value highlight">${result.taxDeduction}</span>
                                            </div>
                                            <div className="detail-row">
                                                <span className="detail-label">Time Saved</span>
                                                <span className="detail-value">15-30 min</span>
                                            </div>
                                        </>
                                    )}
                                </div>

                                <div className="result-actions">
                                    <button className="primary-action" onClick={reset}>
                                        Check Another Item
                                    </button>
                                    <button 
                                        className="secondary-action"
                                        onClick={() => {
                                            trackEvent('mode_selected', { mode: 'bulk', from: 'result' });
                                            setScreen('bulk');
                                        }}
                                    >
                                        üìã Try Bulk Scan
                                    </button>
                                </div>
                            </div>
                        </div>

                        {history.length > 0 && (
                            <button className="history-button" onClick={() => setShowHistory(true)}>
                                üìã History <span className="history-badge">{history.length}</span>
                            </button>
                        )}

                        {showHistory && (
                            <HistoryModal 
                                history={history}
                                onClose={() => setShowHistory(false)}
                                onClear={() => {
                                    setHistory([]);
                                    localStorage.removeItem('sellDonateHistory');
                                    setShowHistory(false);
                                }}
                            />
                        )}
                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                    </>
                );
            }

            // Bulk input
            if (screen === 'bulk') {
                const itemCount = bulkItems.split('\n').filter(i => i.trim()).length;
                
                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center'}}>
                                    <div className="ai-badge">üìã Bulk Scan</div>
                                </div>
                                
                                <h1 style={{fontSize: '24px'}}>Check Multiple Items</h1>
                                <p className="subtitle">One item per line. Be specific for best results.</p>

                                <div className="bulk-input-section">
                                    <textarea
                                        placeholder={"iPhone 12 Pro 128GB\nNike Air Max size 10\nKitchenAid Stand Mixer\nLevi's 501 jeans 32x30"}
                                        value={bulkItems}
                                        onChange={(e) => setBulkItems(e.target.value)}
                                    />
                                    {itemCount > 0 && (
                                        <div className="bulk-item-count">
                                            {itemCount} item{itemCount !== 1 ? 's' : ''} ‚Ä¢ Uses {itemCount} of {scanData.scansRemaining} scans
                                        </div>
                                    )}
                                </div>

                                <button 
                                    className="back-button"
                                    onClick={reset}
                                    style={{marginTop: '15px'}}
                                >
                                    ‚Üê Back
                                </button>

                                <button 
                                    className="action-button"
                                    disabled={itemCount === 0}
                                    onClick={runBulkAnalysis}
                                    style={{marginTop: '10px'}}
                                >
                                    üîç Analyze {itemCount} Item{itemCount !== 1 ? 's' : ''}
                                </button>
                            </div>
                        </div>

                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                        {showUpgrade && <UpgradeModal onClose={() => setShowUpgrade(false)} onShowEmailCapture={handleShowEmailCapture} />}
                        {showEmailCapture && <EmailCaptureModal onClose={() => setShowEmailCapture(false)} lastItem={null} />}
                    </>
                );
            }

            // Bulk results
            if (screen === 'bulkResults') {
                const sellItems = bulkResults.filter(r => r.recommendation === 'sell');
                const totalProfit = sellItems.reduce((sum, r) => sum + parseFloat(r.netProfit || 0), 0);

                return (
                    <>
                        <ScanCounter onClick={() => setShowAccount(true)} />
                        
                        <div className="container">
                            <div className="card">
                                <div style={{textAlign: 'center'}}>
                                    <div className="ai-badge">‚ú® Results Ready</div>
                                </div>
                                
                                <h1 style={{fontSize: '24px'}}>{bulkResults.length} Items Analyzed</h1>
                                
                                {sellItems.length > 0 && (
                                    <div style={{background: '#f0fdf4', padding: '15px', borderRadius: '12px', marginBottom: '20px', textAlign: 'center'}}>
                                        <div style={{fontSize: '14px', color: '#065f46'}}>Potential profit from selling</div>
                                        <div style={{fontSize: '28px', fontWeight: '700', color: '#10b981'}}>${totalProfit.toFixed(2)}</div>
                                    </div>
                                )}

                                <div className="bulk-results">
                                    {bulkResults.map((item, index) => (
                                        <div key={index} className={`bulk-result-item ${item.recommendation}`}>
                                            <div className="bulk-item-name">{item.itemName}</div>
                                            <div className={`bulk-item-recommendation ${item.recommendation}`}>
                                                {item.recommendation === 'sell' ? 'üí∞ SELL' : 
                                                 item.recommendation === 'donate' ? '‚ù§Ô∏è DONATE' : '‚ö†Ô∏è ERROR'}
                                            </div>
                                            {item.recommendation === 'sell' && (
                                                <div className="bulk-item-details">
                                                    Est. profit: ${item.netProfit}
                                                </div>
                                            )}
                                            <div className="bulk-item-details">{item.reason}</div>
                                        </div>
                                    ))}
                                </div>

                                <button className="primary-action" onClick={reset} style={{marginTop: '20px'}}>
                                    Analyze More Items
                                </button>
                            </div>
                        </div>

                        {history.length > 0 && (
                            <button className="history-button" onClick={() => setShowHistory(true)}>
                                üìã History <span className="history-badge">{history.length}</span>
                            </button>
                        )}

                        {showHistory && (
                            <HistoryModal 
                                history={history}
                                onClose={() => setShowHistory(false)}
                                onClear={() => {
                                    setHistory([]);
                                    localStorage.removeItem('sellDonateHistory');
                                    setShowHistory(false);
                                }}
                            />
                        )}
                        {showAccount && <AccountModal onClose={() => setShowAccount(false)} />}
                    </>
                );
            }

            return null;
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
    
    <div class="footer-disclaimer">
        Independent tool. Not affiliated with any marketplace. Data for informational purposes only.
        | <a href="/terms.html">Terms</a> | <a href="/privacy.html">Privacy</a> | <a href="/faq.html">FAQ</a>
    </div>
    
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js').catch(() => {});
            });
        }
    </script>
</body>
</html>
